<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <!-- 设置字符集为UTF-8，确保页面显示中文时没有乱码 -->
    <meta charset="utf-8" />
    
    <!-- 设置视口，确保在不同设备上页面能正确显示，适应手机等小屏设备 -->
    <meta name="viewport" content="width=device-width" />
    
    <!-- 引入外部CSS样式表（自定义的style.css） -->
    <link href="style.css" rel="stylesheet" />
    
    <!-- 引入Google字体库中的Noto Serif字体，适合学术风格 -->
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Serif&display=swap"
      rel="stylesheet" />
    
    <!-- 设置网页标题，出现在浏览器标签栏上 -->
    <title>方俊祺 | 学术主页</title>
    <!-- 引入 Leaflet.js 和样式 -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  </head>
  <body>
    <!-- 页眉部分 -->
    <header>
      <!-- 主标题，显示站点名称或者个人名字 -->
      <h1>方俊祺</h1>
      
      <!-- 个人描述，简短介绍自己 -->
      <p>博士后研究员 · 耳鼻咽喉科学</p>
      
      <!-- 头像图片（可以根据需要自行上传并取消注释） -->
      <!-- <img src="../img/profile.jpg" alt="Profile Photo" width="180" /> -->
    </header>

    <!-- "关于我"部分 -->
    <section>
      <h2>关于我</h2>
      <p>
        我目前在斯坦福大学从事耳鼻咽喉科方向的博士后研究，主要关注医学影像、临床诊断与相关生物信号的学术问题。
      </p>
    </section>

    <!-- "研究方向"部分 -->
    <section>
      <h2>研究方向</h2>
      <ul>
        <li>医学影像处理与分析</li>
        <li>临床诊断技术</li>
        <li>人工智能在耳鼻咽喉科学的应用</li>
      </ul>
    </section>

    <!-- "出版物与成果"部分（此处可以添加具体的学术成果或论文） -->
    <section>
      <h2>出版物与成果</h2>
      <p>（此处可列出代表性论文、会议报告或科研成果）</p>
      <ul>
        <li>示例论文一，期刊名，年份</li>
        <li>示例论文二，会议名，年份</li>
        <li>示例论文三，期刊名，年份</li>
      </ul>
    </section>

    <!-- "友情链接"部分，添加相关领域的同行网站或学术链接 -->
    <section>
      <h2>友情链接</h2>
      <p>
        同行网站：
        <!-- 链接到其他学术网站，这里以王誉晨的网站为例 -->
        <a href="https://parity-w.github.io/YuchenWang.github.io/cn/index.html" target="_blank">
          王誉晨的网站
        </a>
      </p>
    </section>

    <!-- 地图容器 -->
    <section>
      <h2>用户位置显示</h2>
      <div id="map" style="height: 400px;"></div> <!-- 地图容器，指定高度 -->
    </section>

    <script>
      // 获取页面的 body 元素
      const body = document.body;

      // 监听鼠标点击事件
      body.addEventListener('click', function (e) {
        // 创建一个新的圆圈元素
        const circle = document.createElement('div');
        circle.classList.add('click-effect');
        
        // 设置圆圈位置为鼠标点击的位置
        const size = Math.max(body.offsetWidth, body.offsetHeight);
        circle.style.width = circle.style.height = `${size}px`;
        circle.style.left = `${e.clientX - size / 2}px`;
        circle.style.top = `${e.clientY - size / 2}px`;
        
        // 将圆圈添加到页面中
        body.appendChild(circle);
        
        // 动画结束后移除圆圈
        setTimeout(() => {
          circle.remove();
        }, 600); // 600ms后移除
      });
    </script>

    <script>
      // 获取用户地理位置并显示在地图上
      function showUserLocation() {
        if (navigator.geolocation) {
          // 获取用户当前位置
          navigator.geolocation.getCurrentPosition(function (position) {
            const lat = position.coords.latitude; // 纬度
            const lon = position.coords.longitude; // 经度

            // 创建地图
            const map = L.map('map').setView([lat, lon], 13); // 设置地图视图中心为用户当前位置

            // 添加地图的底图（使用 OpenStreetMap）
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
              attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
            }).addTo(map);

            // 在地图上标记当前位置
            const marker = L.marker([lat, lon]).addTo(map);
            marker.bindPopup("您现在的位置").openPopup();

            // 保存用户的位置和访问次数到 localStorage
            let visitData = JSON.parse(localStorage.getItem("visitData")) || [];
            visitData.push({ lat, lon, timestamp: new Date().toISOString() });

            // 将新位置数据保存到 localStorage
            localStorage.setItem("visitData", JSON.stringify(visitData));

            // 记录地图上的所有位置
            visitData.forEach((data) => {
              L.marker([data.lat, data.lon]).addTo(map);
            });
          });
        } else {
          alert("您的浏览器不支持地理位置功能");
        }
      }

      // 页面加载时显示位置
      window.onload = showUserLocation;
    </script>

  </body>
</html>
